name: Build MapCache on Windows
on: [ push ]

jobs:

    build-matrix:
      strategy:
        matrix:
          os: [ windows-2019 ]
          option: [ default ]
      runs-on: ${{ matrix.os }}
      steps:
        - name: Checkout repository
          uses: actions/checkout@v2

        - name: Install dependencies
          run: |
            Set-Location -Path ${{ github.workspace }}
            New-Item -Path . -Name "sdk" -ItemType "directory"
            Set-Location -Path "sdk"
            curl -O https://download.gisinternals.com/sdk/downloads/release-1928-x64-dev.zip
            unzip -qq release-1928-x64-dev.zip

        - name: Build MapCache
          run: |
            Set-Location -Path ${{ github.workspace }}
            New-Item -Path . -Name "build" -ItemType "directory"
            Set-Location -Path "build"
            cmake -DCMAKE_PREFIX_PATH "${{ github.workspace }}\sdk\release-1928-x64" \
                  ${{ github.workspace }}
            make
            sudo make install

